# ============================================
# CONFIGURACIÓN DE PRODUCCIÓN - LOTOLINK
# ============================================
# Este archivo es una plantilla para configuración de producción.
# Copia este archivo a .env y completa con tus valores reales.
# IMPORTANTE: Nunca subas el archivo .env a Git (ya está en .gitignore)

# ============================================
# APPLICATION
# ============================================
NODE_ENV=production
PORT=3000
API_PREFIX=api/v1

# CORS Configuration - SECURITY: Specify exact domains (comma-separated)
# Example: ALLOWED_ORIGINS=https://lotolink.com,https://www.lotolink.com,https://admin.lotolink.com
# NEVER use wildcard (*) in production - always specify exact domains
ALLOWED_ORIGINS=https://tu-dominio.com,https://www.tu-dominio.com

# ============================================
# DATABASE (PostgreSQL)
# ============================================
# Si usas Docker Compose, usa 'postgres' como host
# Si instalación manual, usa 'localhost' o IP del servidor de BD
DATABASE_HOST=postgres
DATABASE_PORT=5432
DATABASE_USERNAME=lotolink
DATABASE_PASSWORD=CAMBIA_ESTO_PASSWORD_SEGURO_MIN_20_CHARS
DATABASE_NAME=lotolink_db

# SSL para conexión a BD (recomendado en producción)
# DATABASE_SSL=true
# DATABASE_SSL_CA=/path/to/ca-certificate.crt

# ============================================
# REDIS CACHE
# ============================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=CAMBIA_ESTO_REDIS_PASSWORD_SEGURO

# ============================================
# RABBITMQ MESSAGE QUEUE
# ============================================
# Formato: amqp://usuario:password@host:puerto
RABBITMQ_URL=amqp://lotolink:CAMBIA_ESTO_RABBITMQ_PASSWORD@rabbitmq:5672
RABBITMQ_QUEUE_PLAYS=plays_queue
RABBITMQ_DLQ=plays_dlq

# ============================================
# JWT AUTHENTICATION
# ============================================
# CRÍTICO: Genera secrets únicos y seguros
# Usa: openssl rand -base64 48
JWT_SECRET=GENERA_SECRET_UNICO_MIN_48_CARACTERES_AQUI_CAMBIA_ESTO
JWT_EXPIRES_IN=1h
JWT_REFRESH_EXPIRES_IN=7d

# ============================================
# HMAC FOR BANCA INTEGRATION
# ============================================
# CRÍTICO: Debe ser diferente al JWT_SECRET
# Usa: openssl rand -base64 48
HMAC_SECRET=GENERA_SECRET_DIFERENTE_MIN_48_CARACTERES_AQUI_CAMBIA_ESTO
HMAC_TIMESTAMP_TOLERANCE_SECONDS=120

# ============================================
# BANCA CONFIGURATION
# ============================================
# En producción debe ser false
USE_MOCK_BANCA=false

# URL del API de la banca real
BANCA_API_URL=https://api-banca.ejemplo.com

# Secret compartido con la banca para HMAC
BANCA_HMAC_SECRET=secret_compartido_con_banca_cambia_esto

# Timeout para llamadas a la banca (30 segundos)
BANCA_TIMEOUT_MS=30000

# ============================================
# PAYMENT GATEWAY (STRIPE)
# ============================================
# En producción debe ser false
USE_MOCK_PAYMENT=false

# Obtén tus claves en: https://dashboard.stripe.com/apikeys
# IMPORTANTE: Usa claves LIVE (sk_live_... y whsec_...)
STRIPE_SECRET_KEY=sk_live_TU_CLAVE_SECRETA_AQUI
STRIPE_WEBHOOK_SECRET=whsec_TU_WEBHOOK_SECRET_AQUI

# ============================================
# COMMISSION CONFIGURATION
# ============================================
# Cuenta de Stripe para depositar comisiones
COMMISSION_STRIPE_ACCOUNT_ID=acct_TU_CUENTA_COMISIONES

# Porcentaje de comisión (5.0 = 5%)
COMMISSION_PERCENTAGE=5.0

# Cuenta de Stripe para fees de procesamiento de tarjetas
CARD_PROCESSING_ACCOUNT_ID=acct_TU_CUENTA_PROCESSING

# ============================================
# LOTTERY RESULTS PROVIDER
# ============================================
# En producción debe ser false cuando tengas proveedor real
USE_MOCK_LOTTERY_RESULTS=false

# API del proveedor oficial de resultados
LOTTERY_RESULTS_API_URL=https://api-resultados-loteria.ejemplo.com
LOTTERY_RESULTS_API_KEY=tu_api_key_del_proveedor

# ============================================
# EMAIL CONFIGURATION
# ============================================
# Habilitar envío de emails
EMAIL_ENABLED=true

# Configuración SMTP - Ejemplo con Gmail
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_SECURE=false

# Credenciales - Para Gmail, usa App Password
EMAIL_USER=tu-email@gmail.com
EMAIL_PASSWORD=tu_app_password_de_gmail

# Remitente de emails
EMAIL_FROM=noreply@lotolink.com

# Email del administrador
ADMIN_EMAIL=admin@lotolink.com

# ============================================
# PLAY WORKER CONFIGURATION
# ============================================
# Reintentos máximos para enviar jugadas a bancas
PLAY_WORKER_MAX_RETRIES=3

# Delay entre reintentos (5 segundos)
PLAY_WORKER_RETRY_DELAY_MS=5000

# ============================================
# LOGGING AND MONITORING
# ============================================
# Nivel de logging: error, warn, info, debug, verbose
LOG_LEVEL=info

# Directorio para logs
LOG_DIR=./logs

# ============================================
# SENTRY ERROR TRACKING (OPCIONAL)
# ============================================
# Obtén tu DSN en: https://sentry.io
# SENTRY_DSN=https://tu-clave@o123456.ingest.sentry.io/123456
# SENTRY_ENVIRONMENT=production
# SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================
# RATE LIMITING CONFIGURATION
# ============================================
# SECURITY: Protects against brute force and DDoS attacks
# RATE_LIMIT_TTL: Time window in milliseconds (default: 900000 = 15 minutes)
# RATE_LIMIT_MAX: Maximum requests per IP per time window (default: 100)
# For stricter limits, reduce RATE_LIMIT_MAX or decrease RATE_LIMIT_TTL
RATE_LIMIT_TTL=900000
RATE_LIMIT_MAX=100

# ============================================
# SECURITY HEADERS (OPCIONAL)
# ============================================
# Habilitar Helmet.js security headers
# HELMET_ENABLED=true

# ============================================
# NOTAS IMPORTANTES
# ============================================
# 1. Cambia TODOS los valores que digan "CAMBIA_ESTO"
# 2. Genera secrets únicos usando: openssl rand -base64 48
# 3. Usa contraseñas fuertes (min 20 caracteres)
# 4. Nunca compartas este archivo .env
# 5. Usa claves de Stripe LIVE (no test)
# 6. Configura backups automáticos de la base de datos
# 7. Habilita HTTPS en producción
# 8. Revisa logs regularmente
